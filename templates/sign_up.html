<!DOCTYPE html>
<html>
<head>
  
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" 
  rel="stylesheet" integrity="sha384-9ndCyUaIbzAi2FUVXJi0CjmCapSmO7SnpJef0486qhLnuZ2cdeRhO02iuK6FUUVM" crossorigin="anonymous">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js" 
  integrity="sha384-geWF76RCwLtnZ8qwWowPQNguL3RmwHVBC9FhGdlKrxdiJJigb/j/68SIy3Te4Bkz" crossorigin="anonymous"></script>
  <title>Registration Form</title>
  <link rel="stylesheet" type="text/css" href="static/css/styles.css">
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <style>
    body {
      margin: 20px;
    }
    
  </style>
</head>

<body>

<div class='signup_container'>
  
  <center>
    <h1><a href="/">ETU</a></h1>
    <img src='/static/images/logo.png' alt='logo' style="width:40px; height:40px">
    <h1>REGISTRATION</h1></center>
  <form method="POST" id='signup'>
  <div class="row">
    <div class="col">
      <label for="regno">Registration No:</label>
      <input type="number" class="form-control" placeholder="Registration Number"  min = "1" max='9999' name="regno" id= 'regno' required>
    </div>
    <div class="col">
      <label>Full Name</label>
      <input type="text" class="form-control" placeholder="Full name" name="fullname" id="fullname"  required>
    </div>
    
  </div>
  <div class="row">
    <div class="col">
        <label>Email</label>
        <input type="email" class="form-control" placeholder="Email" name="email" id="email" required>
    </div>
    <div class="col">
        <label>Password</label>
        <input type="password" class="form-control" placeholder="Password" name="password" id="password" required>
    </div>  
  </div>
  
  <div class="row">
    <div class="col">
    <label>Degree Program:</label>
    <select class="form-control" id="degree" name="degree" required>
      <option value="">Select a degree program</option>
      <option value="Bsc Computer Science and engineering">Bsc Computer Science and engineering</option>
      <option value="Bsc Machinical engineering">Bsc Machinical engineering</option>
      <option value="Bsc Civil engineering">Bsc Civil engineering</option>
      <option value="Bsc Electrical engineering">Bsc Electrical engineering</option>
    </select>
    </div>
    
    <div class="col">
        <label>Contact No</label>
        <input type="tel" class="form-control" placeholder="Contact no" name="contact" id="contact" required>
    </div>
  </div>
  
  <div class="form-group">
    <label for="introduction">Introduction:</label>
    <textarea class="form-control" id="introduction" name="introduction" style="height: 100px" placeholder="Add some introduction about your self" required></textarea>
  </div>
  
  <div class="form-group">
    <label for="skills">Skills:</label>
    <textarea class="form-control" id="skills" name="skills"  placeholder="Add the skills you have developed" style="height: 100px" required></textarea>
  </div>
  
  
  <div class="form-group">
      <center>
      <label for="regno">GPA</label>
      <input type="number" class="form-control" min="0.00" step="0.01" id="gpa" name="gpa" style="width: 300px;" placeholder="GPA" required>
      </center>
  </div>
  
  </br>
  {% if error_msg %}
      <p class="error">{{ error_msg }}</p>
    {% endif %}
  <center>
    <input type="submit" value="REGISTER" class="btn btn-primary">
    <h3><a href="/login" class="already">
    You already have an account? Login here.</a></h3>
  </center>
    
</form>

</div>
<script>
  document.getElementById('signup').addEventListener('submit', function(e) {
      e.preventDefault();
      
      const regNo = parseInt(document.getElementById('regno').value);
      const fullName = document.getElementById('fullname').value;
      const email = document.getElementById('email').value;
      const password = document.getElementById('password').value;
      const degree = document.getElementById('degree').value;
      const contact = document.getElementById('contact').value;
      const introduction = document.getElementById('introduction').value;
      const skills = document.getElementById('skills').value;
      const gpa = parseFloat(document.getElementById('gpa').value);

      const formData = {
        regno: regNo,
        fullname: fullName,
        email: email,
        password: password,
        degree: degree,
        contact: contact,
        introduction: introduction,
        skills: skills,
        gpa: gpa
      };

      fetch('/sign_up', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json'
      },
      body: JSON.stringify(formData)
    })
      .then(response => response.json())
      .then(data => {
        if (data.error_msg) {
          // Display the error message to the user
          swal.fire(data.error_msg);
        } 
          swal.fire("SuccessFully Registered");
          window.location.href='/login'
        
      })
      .catch(error => {
        // Handle the error case
        console.error(error);
        alert('Some error occurred. Please try again later.');
      });

    });
</script>

</body>
</html>
